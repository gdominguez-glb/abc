<% max_level = Spree::Config[:max_level_in_taxons_menu] || 1 %>
<% @taxonomies.each do |taxonomy| %>
  <% cache [I18n.locale, taxonomy, max_level] do %>
    <div class="taxonomy-wrapper">
        <h4 class='taxonomy-root'><%= taxonomy.name %></h4>
        <% selected_taxons = taxonomy.root.children.where(id: params[:taxon_ids]) %>
        <% if selected_taxons.count > 0 %>
          <p>
            <% selected_taxons.each do |selected_taxon| %>
              <span><%= selected_taxon.name %></span>
              <%= link_to params.merge(taxon_ids: (params[:taxon_ids] - [selected_taxon.id.to_s])) do %>	
                <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
              <% end %>
            <% end %>
          </p>
        <% end %>
        <%= video_gallery_taxons_tree(taxonomy.root, @taxon, max_level) %>
    </div>
  <% end %>
<% end %>
