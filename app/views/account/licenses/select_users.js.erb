$('body').append("<%= escape_javascript(render 'select_users_modal') %>");
$('#select-users-modal').modal('show');
$('#select-users-modal').on('hidden.bs.modal', function(e){
  $('#select-users-modal').remove();
});

$('.select-all-users').click(function(e){
  $('.user-checkbox').attr('checked', true);
});

$('#select-users-modal #btnAddUsers').click(function(e){
  var emails = []
  $.each($('.user-checkbox:checked'), function(i, el){
    emails.push($(el).val());
  });
  if (emails.length > 0) {
    $("#licenseRecipients").val(emails.join(','));
    $('#assign_licenses_form_licenses_recipients').val(emails.join(','));
    $('#assign_licenses_form_total').val(emails.length);
  }
  $('#select-users-modal').modal('hide');
});

$(function() {
  $('#btnSelectUsers').on('click', function() {
    $('#userEmails').collapse('hide');
    $('#chooseUsers').collapse('show');
    $('#importUsers').collapse('hide');
  });

  $('#btnUploadUsers').on('click', function() {
    $('#userEmails').collapse('hide');
    $('#chooseUsers').collapse('hide');
    $('#importUsers').collapse('show');
  });

  $('#btnBack, #btnImportBack').on('click', function() {
    $('#userEmails').collapse('show');
    $('#chooseUsers').collapse('hide');
    $('#importUsers').collapse('hide');
  });
});
