<div class="col-sm-10 col-sm-offset-1 margin-top-xxl margin-bottom-xl">
  <div class="row">
    <div class="col-md-12">
      <div class="terms_and_conditions_box">
        <h4><%= Spree.t('terms_and_conditions.title') %></h4>
        <p>
          These are the license terms under which you are authorized to use this content. Please read and click I accept if you wish to proceed.
        </p>
        <div class="terms_and_conditions_text">
            <h5>License for <%= @product.name %></h5>
            <p>
              <%= simple_format @product.license_text %>
            </p>
        </div>

        <div class="margin-top-s">

        </div>
      </div>
        <%= form_tag agree_terms_product_path(@product) do %>
          <%= submit_tag 'Agree And Continue', class: 'btn btn-primary term-continue-button disabled' %>
        <% end %>
      <div class="alert alert-info margin-top"><i class="mi">info_outline</i> Scroll through and accept the terms to continue.</div>
    </div>
  </div>
</div>

<script type="text/javascript">
  $(function(){
    var scrolledToBottom = false;

    if($('.terms_and_conditions_text').get(0).scrollHeight == ($('.terms_and_conditions_text').height() + 40)) {
      setTimeout(function() {
        scrolledToBottom = true;
        activateContinueButton();
      }, 3000)
    } else {
      $('.terms_and_conditions_text').scroll(function () {
        if (($(this).scrollTop() + 40) == $(this).get(0).scrollHeight - $(this).height()) {
          scrolledToBottom = true;
          activateContinueButton();
        }
      });
    }

    function activateContinueButton() {
      if(scrolledToBottom) {
        $('.term-continue-button').removeClass('disabled');
      } else {
        $('.term-continue-button').addClass('disabled');
      }
    }
  })
</script>
