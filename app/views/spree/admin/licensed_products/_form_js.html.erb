<script type="text/javascript">
//<![CDATA[
  (function($){
   $("#admin_new_licenses_form_user_id").select2({
      placeholder: "Select school district admin",
      ajax: {
        url: '/storeapi/users',
        datatype: 'json',
        data: function (term, page) {
          return {
            per_page: 50,
            page: page,
            without_children: true,
            q: {
              email_cont: term
            },
            token: Spree.api_key
          };
        },
        results: function (data, page) {
          var more = page < data.pages;
          return {
            results: data['users'],
            more: more
          };
        }
      },
      formatResult: function (user) {
        return user.email;
      },
      formatSelection: function (user) {
        return user.email;
      }
   });
   $("#admin_new_licenses_form_product_ids").select2({
      placeholder: "Select product",
      multiple: true,
      ajax: {
        url: '/storeapi/products',
        datatype: 'json',
        data: function (term, page) {
          return {
            per_page: 50,
            page: page,
            without_children: true,
            q: {
              name_cont: term
            },
            token: Spree.api_key
          };
        },
        results: function (data, page) {
          var more = page < data.pages;
          return {
            results: data['products'],
            more: more
          };
        }
      },
      formatResult: function (product) {
        return product.name;
      },
      formatSelection: function (product) {
        return product.name;
      }
   });

   $('#admin_new_licenses_form_payment_method_id').change(function(){
     var paymentMethodId = $(this).val();
     togglePaymentMethod(paymentMethodId);
   });

   function togglePaymentMethod(paymentMethodId) {
      $('.payment-method').hide();
      $('#payment-methods :input').prop('disabled', true);
      $("#payment_method_" + paymentMethodId).show();
      $("#payment_method_" + paymentMethodId + ' :input').prop('disabled', false);
   }

   togglePaymentMethod($('#admin_new_licenses_form_payment_method_id').val());

  })(jQuery);
//]]>
</script>
