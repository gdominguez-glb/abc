<div data-hook="admin_video_form_fields" class="row">
  <div class="col-md-6">
    <%= f.field_container :product, class: ['form-group'] do %>
      <%= f.label :product, Spree.t(:product) %>
      <%= f.text_field :product_id, :class => 'form-control' %>
      <%= error_message_on :video, :product %>
    <% end %>
    <%= f.field_container :title, class: ['form-group'] do %>
      <%= f.label :title, Spree.t(:title) %>
      <%= f.text_field :title, :class => 'form-control' %>
      <%= error_message_on :video, :title %>
    <% end %>
    <%= f.field_container :is_free, class: ['form-group'] do %>
      <%= f.label :is_free, Spree.t(:is_free) %>
      <%= f.check_box :is_free, :class => 'form-control' %>
    <% end %>
    <div data-hook="admin_product_form_taxons">
      <%= f.field_container :taxons, class: ['form-group'] do %>
        <%= f.label :taxon_ids, Spree.t(:taxons) %>
        <%= f.hidden_field :taxon_ids, value: @video.taxon_ids.join(',') %>
      <% end %>
    </div>
    <%= f.field_container :description, class: ['form-group'] do %>
      <%= f.label :description, Spree.t(:description) %>
      <%= f.text_area :description, :class => 'form-control', rows: 3 %>
      <%= error_message_on :video, :description %>
    <% end %>
    <%= f.field_container :file, class: ['form-group'] do %>
      <%= f.label :file, Spree.t(:file) %>
      <%= f.file_field :file, :class => 'form-control' %>
      <%= error_message_on :video, :file %>
    <% end %>
  </div>
</div>
<script type="text/javascript">
//<![CDATA[
  (function($){
    $(document).ready(function () {
      set_taxon_select('#video_taxon_ids')
    });
   $("#video_product_id").select2({
      placeholder: "Select product",
      multiple: false,
      initSelection: function (element, callback) {
        var url = Spree.url('/storeapi/products', {
          ids: element.val(),
          token: Spree.api_key
        });
        return $.getJSON(url, null, function (data) {
          return callback(data['products'][0]);
        });
      },
      ajax: {
        url: '/storeapi/products',
        datatype: 'json',
        data: function (term, page) {
          return {
            per_page: 50,
            page: page,
            without_children: true,
            q: {
              name_cont: term
            },
            token: Spree.api_key
          };
        },
        results: function (data, page) {
          var more = page < data.pages;
          return {
            results: data['products'],
            more: more
          };
        }
      },
      formatResult: function (product) {
        return product.name;
      },
      formatSelection: function (product) {
        return product.name;
      }
   });
  })(jQuery);
//]]>
</script>
