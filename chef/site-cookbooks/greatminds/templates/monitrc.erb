check process nginx with pidfile /var/run/nginx.pid
    start program = "/etc/init.d/nginx start"
    stop program = "/etc/init.d/nginx stop"

check process postgresql9.3 with pidfile /var/lib/postgresql/9.3/main/postmaster.pid
    group database
    start program = "/etc/init.d/postgresql start"
    stop  program = "/etc/init.d/postgresql stop"

check process unicorn with pidfile /var/www/<%= node['app'] %>/current/tmp/pids/unicorn.pid
  start program = "/etc/init.d/unicorn_<%= node['app'] %> start"
  stop program = "/etc/init.d/unicorn_<%= node['app'] %> stop"
  group unicorn

check process redis-server with pidfile "/var/run/redis_6379.pid"
  start program = "/etc/init.d/redis_6379 start"
  stop program = "/etc/init.d/redis_6379 stop"
  if 2 restarts within 3 cycles then timeout
  if totalmem > 100 Mb then alert
  if children > 255 for 5 cycles then stop
  if cpu usage > 95% for 3 cycles then restart
  if failed host 127.0.0.1 port 6379 then restart
  if 5 restarts within 5 cycles then timeout
